---
layout: post
title: Russian Lottery
tags:
- Economics
- Mathematics
- Probability and Statistics
status: publish
type: post
published: true
meta:
  _edit_last: '1'
  _syntaxhighlighter_encoded: '1'
  _wp_old_slug: ''
has_latex: true
---
<p>Today, during my microeconomics class at UC Berkeley, I came across an interesting paradox that reminded me of one of <a href="http://renaudbourassa.com/blog/2009/04/04/the-drunkards-walk/">The Drunkard's Walk</a> main thesis. In his book, Leonard Mlodinow argues that most people react badly to situation involving probabilities due to their inaptitude at calculating probabilistic outcomes correclty. The <a href="http://en.wikipedia.org/wiki/St._Petersburg_paradox">St. Petersburg paradox</a> is a perfect example of this.</p>

<p>The St. Petersburg paradox takes the form of a lottery, where the player buys his way in for a fixed fee. The dealer then puts a dollar in a jar and flip a coin. If the coin ends on tail, the game is over and the player takes the money currently in the jar. However, if it ends on head, the amount in the jar is doubled and the coin is flipped again. This is repeated until a head appears and the player takes the money in the jar.</p>

<p>Now, the paradox doesn't come from the game itself, but from the fixed fee. The question is, how much would you be willing to pay to enter the game? When asked this question, most people are reluctant to put more than $25. An easy way to calculate the maximum amount a person should be willing to put is to calculate the <a href="http://en.wikipedia.org/wiki/Expected_value">expected value</a> of the game. A rational person would not bet more than its expected gain. But what is the expected gain of the game exactly? Here are a list of possible gains and their probability.</p>

<table style="text-align:center; width:450px; margin:auto;">
<tr style="height:20px;">
<th style="text-align:center; width:150px;">$latex {Nb. of Heads}$</th>
<th style="text-align:center; width:150px;">$latex {Probability}$</th>
<th style="text-align:center; width:150px;">$latex {Gain}$</th>
</tr>
<tr style="height:20px;">
<td>$latex 0$</td>
<td>$latex \frac{1}{2}$</td>
<td>$latex 1$</td>
</tr>
<tr style="height:20px;">
<td>$latex 1$</td>
<td>$latex \frac{1}{4}$</td>
<td>$latex 2$</td>
</tr>
<tr style="height:20px;">
<td>$latex \cdots$</td>
<td>$latex \cdots$</td>
<td>$latex \cdots$</td>
</tr>
<tr style="height:20px;">
<td>$latex n$</td>
<td>$latex \frac{1}{2^{n}}$</td>
<td>$latex 2^{n-1}$</td>
</tr>
</table>

<p>And so the expected gain can be calculated by adding the individual gains multiplied by their probability of happening.</p>

<p style="margin-left:25px;">$latex E(G)=\frac{1}{2}\cdot 1 + \frac{1}{4}\cdot 2 + \cdots =\sum_{n=1}^{\infty }\frac{1}{2^{n}}\cdot 2^{n-1}$</p>

<p>Which is a series that does not converge.</p>

<p style="margin-left:25px;">$latex E(G)=\sum_{n=1}^{\infty }\frac{1}{2}=\infty$</p>

<p>And results in an infinite expected gain. So what does that mean? That means that you should be ready to pay any fixed fee to enter the lottery. This may seems counter intuitive at first, but here is the result of a simulation using a simple python script with an initial fee of $25 and 500,000 repetitions.</p>

<a href="http://dl.dropbox.com/u/1417283/site/uploads/2010/11/plot.png"><img src="http://dl.dropbox.com/u/1417283/site/uploads/2010/11/plot.png" alt="" title="plot" width="400" height="300" class="alignnone size-full wp-image-594" /></a>

<p>As can be seen, the final gain is more than $4,000,000! So next time you gamble in St. Petersburg, don't hesitate to borrow.</p>

<p>Here is the code used for the simulation.</p>

{% highlight python linenos %}
#!/usr/bin/env python2.7
#
# Copyright 2010 Renaud Bourassa

"""
A simple simulation for the St. Petersburg Paradox. Run the simulation and then
plots the results.
"""

__author__  = 'Renaud Bourassa'
__version__ = '1.0.0'

import random
import sys
import matplotlib.pyplot as plt

class Lottery(object):
    """
    Simple Lottery object to simulate one or more game of St. Petersburg lottery
    and keep track of the balance of the player.
    """
    def __init__(self, fee, balance=0):
        """
        Sets the fee and initial balance.
        """
        self.fee = fee
        self.bal = balance

    def play(self):
        """
        Plays one game, returning the resulting balance.
        """
        pot = 1
        while int(random.random() * 2):
            pot *= 2
        self.bal += pot - self.fee
        return self.bal

    def multi_play(self, num_plays):
        """
        Plays multiple games, returning an history of the balance as alist.
        """
        return [self.play() for _ in range(num_plays)]

def get_args():
    """
    Tries to parse the command line arguments.
    """
    try:
        fee = int(sys.argv[1])
        num = int(sys.argv[2])
        bal = int(sys.argv[3]) if len(sys.argv) > 3 else 0
        return {'fee':fee, 'num':num, 'bal':bal}
    except:
        print "usage: %s FEE PLAYS [BALANCE]" % (sys.argv[0])
        return None

if __name__ == "__main__":
    """
    Runs a simulation and graph the results.
    """
    args = get_args()
    if args:
        l = Lottery(args['fee'], args['bal'])
        plt.plot(l.multi_play(args['num']))
        plt.show()
{% endhighlight %}
